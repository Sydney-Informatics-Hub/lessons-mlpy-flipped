<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />




<title>03-EDA.utf8</title>

<script src="site_libs/header-attrs-2.5.3/header-attrs.js"></script>
<script src="site_libs/jquery-1.11.3/jquery.min.js"></script>
<meta name="viewport" content="width=device-width, initial-scale=1" />
<link href="site_libs/bootstrap-3.3.5/css/journal.min.css" rel="stylesheet" />
<script src="site_libs/bootstrap-3.3.5/js/bootstrap.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/html5shiv.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/respond.min.js"></script>
<script src="site_libs/jqueryui-1.11.4/jquery-ui.min.js"></script>
<link href="site_libs/tocify-1.9.1/jquery.tocify.css" rel="stylesheet" />
<script src="site_libs/tocify-1.9.1/jquery.tocify.js"></script>
<script src="site_libs/navigation-1.1/tabsets.js"></script>
<link href="site_libs/highlightjs-9.12.0/default.css" rel="stylesheet" />
<script src="site_libs/highlightjs-9.12.0/highlight.js"></script>

<style type="text/css">
  code{white-space: pre-wrap;}
  span.smallcaps{font-variant: small-caps;}
  span.underline{text-decoration: underline;}
  div.column{display: inline-block; vertical-align: top; width: 50%;}
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
  ul.task-list{list-style: none;}
    </style>

<style type="text/css">code{white-space: pre;}</style>
<style type="text/css">
  pre:not([class]) {
    background-color: white;
  }
</style>
<script type="text/javascript">
if (window.hljs) {
  hljs.configure({languages: []});
  hljs.initHighlightingOnLoad();
  if (document.readyState && document.readyState === "complete") {
    window.setTimeout(function() { hljs.initHighlighting(); }, 0);
  }
}
</script>



<style type="text/css">
h1 {
  font-size: 34px;
}
h1.title {
  font-size: 38px;
}
h2 {
  font-size: 30px;
}
h3 {
  font-size: 24px;
}
h4 {
  font-size: 18px;
}
h5 {
  font-size: 16px;
}
h6 {
  font-size: 12px;
}
.table th:not([align]) {
  text-align: left;
}
</style>

<link rel="stylesheet" href="lesson.css" type="text/css" />



<style type = "text/css">
.main-container {
  max-width: 940px;
  margin-left: auto;
  margin-right: auto;
}
code {
  color: inherit;
  background-color: rgba(0, 0, 0, 0.04);
}
img {
  max-width:100%;
}
.tabbed-pane {
  padding-top: 12px;
}
.html-widget {
  margin-bottom: 20px;
}
button.code-folding-btn:focus {
  outline: none;
}
summary {
  display: list-item;
}
</style>


<style type="text/css">
/* padding for bootstrap navbar */
body {
  padding-top: 61px;
  padding-bottom: 40px;
}
/* offset scroll position for anchor links (for fixed navbar)  */
.section h1 {
  padding-top: 66px;
  margin-top: -66px;
}
.section h2 {
  padding-top: 66px;
  margin-top: -66px;
}
.section h3 {
  padding-top: 66px;
  margin-top: -66px;
}
.section h4 {
  padding-top: 66px;
  margin-top: -66px;
}
.section h5 {
  padding-top: 66px;
  margin-top: -66px;
}
.section h6 {
  padding-top: 66px;
  margin-top: -66px;
}
.dropdown-submenu {
  position: relative;
}
.dropdown-submenu>.dropdown-menu {
  top: 0;
  left: 100%;
  margin-top: -6px;
  margin-left: -1px;
  border-radius: 0 6px 6px 6px;
}
.dropdown-submenu:hover>.dropdown-menu {
  display: block;
}
.dropdown-submenu>a:after {
  display: block;
  content: " ";
  float: right;
  width: 0;
  height: 0;
  border-color: transparent;
  border-style: solid;
  border-width: 5px 0 5px 5px;
  border-left-color: #cccccc;
  margin-top: 5px;
  margin-right: -10px;
}
.dropdown-submenu:hover>a:after {
  border-left-color: #ffffff;
}
.dropdown-submenu.pull-left {
  float: none;
}
.dropdown-submenu.pull-left>.dropdown-menu {
  left: -100%;
  margin-left: 10px;
  border-radius: 6px 0 6px 6px;
}
</style>

<script>
// manage active state of menu based on current page
$(document).ready(function () {
  // active menu anchor
  href = window.location.pathname
  href = href.substr(href.lastIndexOf('/') + 1)
  if (href === "")
    href = "index.html";
  var menuAnchor = $('a[href="' + href + '"]');

  // mark it active
  menuAnchor.parent().addClass('active');

  // if it's got a parent navbar menu mark it active as well
  menuAnchor.closest('li.dropdown').addClass('active');
});
</script>

<!-- tabsets -->

<style type="text/css">
.tabset-dropdown > .nav-tabs {
  display: inline-table;
  max-height: 500px;
  min-height: 44px;
  overflow-y: auto;
  background: white;
  border: 1px solid #ddd;
  border-radius: 4px;
}

.tabset-dropdown > .nav-tabs > li.active:before {
  content: "";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li.active:before {
  content: "&#xe258;";
  border: none;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open:before {
  content: "";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs > li.active {
  display: block;
}

.tabset-dropdown > .nav-tabs > li > a,
.tabset-dropdown > .nav-tabs > li > a:focus,
.tabset-dropdown > .nav-tabs > li > a:hover {
  border: none;
  display: inline-block;
  border-radius: 4px;
  background-color: transparent;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li {
  display: block;
  float: none;
}

.tabset-dropdown > .nav-tabs > li {
  display: none;
}
</style>

<!-- code folding -->



<style type="text/css">

#TOC {
  margin: 25px 0px 20px 0px;
}
@media (max-width: 768px) {
#TOC {
  position: relative;
  width: 100%;
}
}

@media print {
.toc-content {
  /* see https://github.com/w3c/csswg-drafts/issues/4434 */
  float: right;
}
}

.toc-content {
  padding-left: 30px;
  padding-right: 40px;
}

div.main-container {
  max-width: 1200px;
}

div.tocify {
  width: 20%;
  max-width: 260px;
  max-height: 85%;
}

@media (min-width: 768px) and (max-width: 991px) {
  div.tocify {
    width: 25%;
  }
}

@media (max-width: 767px) {
  div.tocify {
    width: 100%;
    max-width: none;
  }
}

.tocify ul, .tocify li {
  line-height: 20px;
}

.tocify-subheader .tocify-item {
  font-size: 0.90em;
}

.tocify .list-group-item {
  border-radius: 0px;
}


</style>



</head>

<body>


<div class="container-fluid main-container">


<!-- setup 3col/9col grid for toc_float and main content  -->
<div class="row-fluid">
<div class="col-xs-12 col-sm-4 col-md-3">
<div id="TOC" class="tocify">
</div>
</div>

<div class="toc-content col-xs-12 col-sm-8 col-md-9">




<div class="navbar navbar-default  navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="index.html">Home</a>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="setup.html">Setup</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Session 1
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="03-EDA.html">Exploratory Data Analysis</a>
    </li>
    <li>
      <a href="10-LinReg.html">Linear Regression</a>
    </li>
  </ul>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Session 2
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="11-RidgeLassoElasticNet.html">Regularised regression. PCR and PLSR.</a>
    </li>
    <li>
      <a href="30-RF_knn.html">Random Forests and k-NN regression</a>
    </li>
    <li>
      <a href="45-Xgboost.html">Gradient boosting. Extreme Gradient Boosting (XGBoost)</a>
    </li>
  </ul>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Session 3
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="50-Classification.html">Classification</a>
    </li>
  </ul>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Session 4
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="50-Classification.html">Classification (finish)</a>
    </li>
    <li>
      <a href="90-Unsupervised.html">Unsupervised learning</a>
    </li>
  </ul>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        
      </ul>
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

<div class="fluid-row" id="header">




</div>


<!--
---
title: "Exploratory Data Analysis (EDA) for Regression"
author: "Darya Vanichkina, David Kohn"
keypoints: 
- EDA is the first step of any analysis, and often very time consuming.
- Skipping EDA can result in substantial issues with subsequent analysis.
questions:
- How do we predict one continuous variable based on others?
- What is the first step of any ML project (and often the most time consuming)?
objectives:
- Introduce some of the key packages for EDA and ML
- Introduce and explore the Ames Housing dataset
source: Rmd
teaching: 30
exercises: 30
bibliography: references.bib
---
-->
<div id="exploratory-data-analysis-eda-for-regression" class="section level3">
<h3>Exploratory Data Analysis (EDA) for Regression</h3>
<p>First, let’s load the required libraries. We will use the sklearn library for our ML tasks, and the pandas, numpy, matplotlib seaborn and upsetplot libraries for general data processing and visualisation.</p>
<pre class="python"><code>import matplotlib.pyplot as plt
import numpy as np
import pandas as pd
import statsmodels.api as sm
import seaborn as sns
from sklearn import preprocessing
from sklearn import model_selection
import upsetplot
%matplotlib inline
sns.set(font_scale = 1.5)</code></pre>
</div>
<div id="load-the-data" class="section level2">
<h2>Load the data</h2>
<p>We will use the Ames housing data to explore different ML approaches to regression. This dataset was “designed” by Dean De Cock as an alternative to the “classic” Boston housing dataset, and has been extensively used in ML teaching. It is also available from kaggle as part of its <a href="https://www.kaggle.com/c/house-prices-advanced-regression-techniques">advanced regression practice competition</a>.</p>
<p>The Ames Housing <a href="https://github.sydney.edu.au/informatics/lessons-mlr/blob/gh-pages/_episodes_rmd/data/AmesHousing_DataDocumentation.txt">Data Documentation file</a> describes the independent variables presented in the data. This includes:</p>
<ul>
<li>20 continuous variables relate to various area dimensions for each observation</li>
<li>14 discrete variables, which typically quantify the number of items occurring within the house</li>
<li>23 ordinal, 23 nominal categorical variables, with 2 (STREET: gravel or paved) - 28 (NEIGHBORHOOD) classes</li>
</ul>
<p>We will explore both the “uncleaned” data available from kaggle/UCI, and the processed data available in the AmesHousing package in R, for which documentation is available <a href="https://cran.r-project.org/web/packages/AmesHousing/AmesHousing.pdf">here</a>. It can be useful for understanding what each of the independent variables mean.</p>
<pre class="python"><code>ameshousingClean = pd.read_csv(&#39;data/AmesHousingClean.csv&#39;)
ameshousingDirty = pd.read_csv(&#39;data/AmesHousingDirty.csv&#39;)</code></pre>
</div>
<div id="exploratory-data-analysis" class="section level2">
<h2>Exploratory data analysis</h2>
<p>Exploratory data analysis involves looking at:</p>
<ul>
<li>the distribution of variables in your dataset</li>
<li>whether any data is missing</li>
<li>skewed</li>
<li>correlated variables</li>
</ul>
<blockquote>
<h2 id="challenge">Challenge</h2>
<ol style="list-style-type: decimal">
<li><p>Explore the Ames Housing dataset. What can you figure out about the different variables? Which do you think are more or less important?</p></li>
<li><p>Compare the “Clean” and “Dirty” datasets:</p></li>
</ol>
<ul>
<li>What was missing in the raw data?</li>
<li>What are some of the approaches that have been taken to deal with missingness?</li>
</ul>
<p>{: .source}</p>
<blockquote>
<h2 id="solution">Solution</h2>
<p>print(ameshousingClean.shape)</p>
<p>print(ameshousingDirty.shape)</p>
<p>Let’s now proceed to explore the rest of the answers to this challenge.</p>
<p>{: .output} {: .solution} {: .challenge}</p>
</blockquote>
</blockquote>
<p>What are the dimensions of the data?</p>
<p>Look at the data:</p>
<pre class="python"><code>ameshousingClean.head()</code></pre>
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
<thead>
<tr style="text-align: right;">
<th>
</th>
<th>
MS_SubClass
</th>
<th>
MS_Zoning
</th>
<th>
Lot_Frontage
</th>
<th>
Lot_Area
</th>
<th>
Street
</th>
<th>
Alley
</th>
<th>
Lot_Shape
</th>
<th>
Land_Contour
</th>
<th>
Utilities
</th>
<th>
Lot_Config
</th>
<th>
…
</th>
<th>
Fence
</th>
<th>
Misc_Feature
</th>
<th>
Misc_Val
</th>
<th>
Mo_Sold
</th>
<th>
Year_Sold
</th>
<th>
Sale_Type
</th>
<th>
Sale_Condition
</th>
<th>
Sale_Price
</th>
<th>
Longitude
</th>
<th>
Latitude
</th>
</tr>
</thead>
<tbody>
<tr>
<th>
0
</th>
<td>
One_Story_1946_and_Newer_All_Styles
</td>
<td>
Residential_Low_Density
</td>
<td>
141
</td>
<td>
31770
</td>
<td>
Pave
</td>
<td>
No_Alley_Access
</td>
<td>
Slightly_Irregular
</td>
<td>
Lvl
</td>
<td>
AllPub
</td>
<td>
Corner
</td>
<td>
…
</td>
<td>
No_Fence
</td>
<td>
None
</td>
<td>
0
</td>
<td>
5
</td>
<td>
2010
</td>
<td>
WD
</td>
<td>
Normal
</td>
<td>
215000
</td>
<td>
-93.619754
</td>
<td>
42.054035
</td>
</tr>
<tr>
<th>
1
</th>
<td>
One_Story_1946_and_Newer_All_Styles
</td>
<td>
Residential_High_Density
</td>
<td>
80
</td>
<td>
11622
</td>
<td>
Pave
</td>
<td>
No_Alley_Access
</td>
<td>
Regular
</td>
<td>
Lvl
</td>
<td>
AllPub
</td>
<td>
Inside
</td>
<td>
…
</td>
<td>
Minimum_Privacy
</td>
<td>
None
</td>
<td>
0
</td>
<td>
6
</td>
<td>
2010
</td>
<td>
WD
</td>
<td>
Normal
</td>
<td>
105000
</td>
<td>
-93.619756
</td>
<td>
42.053014
</td>
</tr>
<tr>
<th>
2
</th>
<td>
One_Story_1946_and_Newer_All_Styles
</td>
<td>
Residential_Low_Density
</td>
<td>
81
</td>
<td>
14267
</td>
<td>
Pave
</td>
<td>
No_Alley_Access
</td>
<td>
Slightly_Irregular
</td>
<td>
Lvl
</td>
<td>
AllPub
</td>
<td>
Corner
</td>
<td>
…
</td>
<td>
No_Fence
</td>
<td>
Gar2
</td>
<td>
12500
</td>
<td>
6
</td>
<td>
2010
</td>
<td>
WD
</td>
<td>
Normal
</td>
<td>
172000
</td>
<td>
-93.619387
</td>
<td>
42.052659
</td>
</tr>
<tr>
<th>
3
</th>
<td>
One_Story_1946_and_Newer_All_Styles
</td>
<td>
Residential_Low_Density
</td>
<td>
93
</td>
<td>
11160
</td>
<td>
Pave
</td>
<td>
No_Alley_Access
</td>
<td>
Regular
</td>
<td>
Lvl
</td>
<td>
AllPub
</td>
<td>
Corner
</td>
<td>
…
</td>
<td>
No_Fence
</td>
<td>
None
</td>
<td>
0
</td>
<td>
4
</td>
<td>
2010
</td>
<td>
WD
</td>
<td>
Normal
</td>
<td>
244000
</td>
<td>
-93.617320
</td>
<td>
42.051245
</td>
</tr>
<tr>
<th>
4
</th>
<td>
Two_Story_1946_and_Newer
</td>
<td>
Residential_Low_Density
</td>
<td>
74
</td>
<td>
13830
</td>
<td>
Pave
</td>
<td>
No_Alley_Access
</td>
<td>
Slightly_Irregular
</td>
<td>
Lvl
</td>
<td>
AllPub
</td>
<td>
Inside
</td>
<td>
…
</td>
<td>
Minimum_Privacy
</td>
<td>
None
</td>
<td>
0
</td>
<td>
3
</td>
<td>
2010
</td>
<td>
WD
</td>
<td>
Normal
</td>
<td>
189900
</td>
<td>
-93.638933
</td>
<td>
42.060899
</td>
</tr>
</tbody>
</table>
<p>
5 rows × 81 columns
</p>
</div>
<p>What types are each of the columns?</p>
<pre class="python"><code>ameshousingClean.dtypes</code></pre>
<pre><code>MS_SubClass        object
MS_Zoning          object
Lot_Frontage        int64
Lot_Area            int64
Street             object
                   ...   
Sale_Type          object
Sale_Condition     object
Sale_Price          int64
Longitude         float64
Latitude          float64
Length: 81, dtype: object</code></pre>
<p>Get information about index type and column types, non-null values and memory usage.</p>
<pre class="python"><code>ameshousingClean.info()</code></pre>
<pre><code>&lt;class &#39;pandas.core.frame.DataFrame&#39;&gt;
RangeIndex: 2930 entries, 0 to 2929
Data columns (total 81 columns):
 #   Column              Non-Null Count  Dtype  
---  ------              --------------  -----  
 0   MS_SubClass         2930 non-null   object 
 1   MS_Zoning           2930 non-null   object 
 2   Lot_Frontage        2930 non-null   int64  
 3   Lot_Area            2930 non-null   int64  
 4   Street              2930 non-null   object 
 5   Alley               2930 non-null   object 
 6   Lot_Shape           2930 non-null   object 
 7   Land_Contour        2930 non-null   object 
 8   Utilities           2930 non-null   object 
 9   Lot_Config          2930 non-null   object 
 10  Land_Slope          2930 non-null   object 
 11  Neighborhood        2930 non-null   object 
 12  Condition_1         2930 non-null   object 
 13  Condition_2         2930 non-null   object 
 14  Bldg_Type           2930 non-null   object 
 15  House_Style         2930 non-null   object 
 16  Overall_Qual        2930 non-null   object 
 17  Overall_Cond        2930 non-null   object 
 18  Year_Built          2930 non-null   int64  
 19  Year_Remod_Add      2930 non-null   int64  
 20  Roof_Style          2930 non-null   object 
 21  Roof_Matl           2930 non-null   object 
 22  Exterior_1st        2930 non-null   object 
 23  Exterior_2nd        2930 non-null   object 
 24  Mas_Vnr_Type        2930 non-null   object 
 25  Mas_Vnr_Area        2930 non-null   int64  
 26  Exter_Qual          2930 non-null   object 
 27  Exter_Cond          2930 non-null   object 
 28  Foundation          2930 non-null   object 
 29  Bsmt_Qual           2930 non-null   object 
 30  Bsmt_Cond           2930 non-null   object 
 31  Bsmt_Exposure       2930 non-null   object 
 32  BsmtFin_Type_1      2930 non-null   object 
 33  BsmtFin_SF_1        2930 non-null   int64  
 34  BsmtFin_Type_2      2930 non-null   object 
 35  BsmtFin_SF_2        2930 non-null   int64  
 36  Bsmt_Unf_SF         2930 non-null   int64  
 37  Total_Bsmt_SF       2930 non-null   int64  
 38  Heating             2930 non-null   object 
 39  Heating_QC          2930 non-null   object 
 40  Central_Air         2930 non-null   object 
 41  Electrical          2930 non-null   object 
 42  First_Flr_SF        2930 non-null   int64  
 43  Second_Flr_SF       2930 non-null   int64  
 44  Low_Qual_Fin_SF     2930 non-null   int64  
 45  Gr_Liv_Area         2930 non-null   int64  
 46  Bsmt_Full_Bath      2930 non-null   int64  
 47  Bsmt_Half_Bath      2930 non-null   int64  
 48  Full_Bath           2930 non-null   int64  
 49  Half_Bath           2930 non-null   int64  
 50  Bedroom_AbvGr       2930 non-null   int64  
 51  Kitchen_AbvGr       2930 non-null   int64  
 52  Kitchen_Qual        2930 non-null   object 
 53  TotRms_AbvGrd       2930 non-null   int64  
 54  Functional          2930 non-null   object 
 55  Fireplaces          2930 non-null   int64  
 56  Fireplace_Qu        2930 non-null   object 
 57  Garage_Type         2930 non-null   object 
 58  Garage_Finish       2930 non-null   object 
 59  Garage_Cars         2930 non-null   int64  
 60  Garage_Area         2930 non-null   int64  
 61  Garage_Qual         2930 non-null   object 
 62  Garage_Cond         2930 non-null   object 
 63  Paved_Drive         2930 non-null   object 
 64  Wood_Deck_SF        2930 non-null   int64  
 65  Open_Porch_SF       2930 non-null   int64  
 66  Enclosed_Porch      2930 non-null   int64  
 67  Three_season_porch  2930 non-null   int64  
 68  Screen_Porch        2930 non-null   int64  
 69  Pool_Area           2930 non-null   int64  
 70  Pool_QC             2930 non-null   object 
 71  Fence               2930 non-null   object 
 72  Misc_Feature        2930 non-null   object 
 73  Misc_Val            2930 non-null   int64  
 74  Mo_Sold             2930 non-null   int64  
 75  Year_Sold           2930 non-null   int64  
 76  Sale_Type           2930 non-null   object 
 77  Sale_Condition      2930 non-null   object 
 78  Sale_Price          2930 non-null   int64  
 79  Longitude           2930 non-null   float64
 80  Latitude            2930 non-null   float64
dtypes: float64(2), int64(33), object(46)
memory usage: 1.8+ MB</code></pre>
<p>Compare with “non-clean” dataset</p>
<pre class="python"><code>ameshousingDirty.info()</code></pre>
<pre><code>&lt;class &#39;pandas.core.frame.DataFrame&#39;&gt;
RangeIndex: 2930 entries, 0 to 2929
Data columns (total 82 columns):
 #   Column           Non-Null Count  Dtype  
---  ------           --------------  -----  
 0   Order            2930 non-null   int64  
 1   PID              2930 non-null   int64  
 2   MS SubClass      2930 non-null   int64  
 3   MS Zoning        2930 non-null   object 
 4   Lot Frontage     2440 non-null   float64
 5   Lot Area         2930 non-null   int64  
 6   Street           2930 non-null   object 
 7   Alley            198 non-null    object 
 8   Lot Shape        2930 non-null   object 
 9   Land Contour     2930 non-null   object 
 10  Utilities        2930 non-null   object 
 11  Lot Config       2930 non-null   object 
 12  Land Slope       2930 non-null   object 
 13  Neighborhood     2930 non-null   object 
 14  Condition 1      2930 non-null   object 
 15  Condition 2      2930 non-null   object 
 16  Bldg Type        2930 non-null   object 
 17  House Style      2930 non-null   object 
 18  Overall Qual     2930 non-null   int64  
 19  Overall Cond     2930 non-null   int64  
 20  Year Built       2930 non-null   int64  
 21  Year Remod/Add   2930 non-null   int64  
 22  Roof Style       2930 non-null   object 
 23  Roof Matl        2930 non-null   object 
 24  Exterior 1st     2930 non-null   object 
 25  Exterior 2nd     2930 non-null   object 
 26  Mas Vnr Type     2907 non-null   object 
 27  Mas Vnr Area     2907 non-null   float64
 28  Exter Qual       2930 non-null   object 
 29  Exter Cond       2930 non-null   object 
 30  Foundation       2930 non-null   object 
 31  Bsmt Qual        2850 non-null   object 
 32  Bsmt Cond        2850 non-null   object 
 33  Bsmt Exposure    2847 non-null   object 
 34  BsmtFin Type 1   2850 non-null   object 
 35  BsmtFin SF 1     2929 non-null   float64
 36  BsmtFin Type 2   2849 non-null   object 
 37  BsmtFin SF 2     2929 non-null   float64
 38  Bsmt Unf SF      2929 non-null   float64
 39  Total Bsmt SF    2929 non-null   float64
 40  Heating          2930 non-null   object 
 41  Heating QC       2930 non-null   object 
 42  Central Air      2930 non-null   object 
 43  Electrical       2929 non-null   object 
 44  1st Flr SF       2930 non-null   int64  
 45  2nd Flr SF       2930 non-null   int64  
 46  Low Qual Fin SF  2930 non-null   int64  
 47  Gr Liv Area      2930 non-null   int64  
 48  Bsmt Full Bath   2928 non-null   float64
 49  Bsmt Half Bath   2928 non-null   float64
 50  Full Bath        2930 non-null   int64  
 51  Half Bath        2930 non-null   int64  
 52  Bedroom AbvGr    2930 non-null   int64  
 53  Kitchen AbvGr    2930 non-null   int64  
 54  Kitchen Qual     2930 non-null   object 
 55  TotRms AbvGrd    2930 non-null   int64  
 56  Functional       2930 non-null   object 
 57  Fireplaces       2930 non-null   int64  
 58  Fireplace Qu     1508 non-null   object 
 59  Garage Type      2773 non-null   object 
 60  Garage Yr Blt    2771 non-null   float64
 61  Garage Finish    2771 non-null   object 
 62  Garage Cars      2929 non-null   float64
 63  Garage Area      2929 non-null   float64
 64  Garage Qual      2771 non-null   object 
 65  Garage Cond      2771 non-null   object 
 66  Paved Drive      2930 non-null   object 
 67  Wood Deck SF     2930 non-null   int64  
 68  Open Porch SF    2930 non-null   int64  
 69  Enclosed Porch   2930 non-null   int64  
 70  3Ssn Porch       2930 non-null   int64  
 71  Screen Porch     2930 non-null   int64  
 72  Pool Area        2930 non-null   int64  
 73  Pool QC          13 non-null     object 
 74  Fence            572 non-null    object 
 75  Misc Feature     106 non-null    object 
 76  Misc Val         2930 non-null   int64  
 77  Mo Sold          2930 non-null   int64  
 78  Yr Sold          2930 non-null   int64  
 79  Sale Type        2930 non-null   object 
 80  Sale Condition   2930 non-null   object 
 81  SalePrice        2930 non-null   int64  
dtypes: float64(11), int64(28), object(43)
memory usage: 1.8+ MB</code></pre>
<p>Explore how many null values are in the clean dataset</p>
<pre class="python"><code>ameshousingClean.isnull().sum(axis = 0)</code></pre>
<pre><code>MS_SubClass       0
MS_Zoning         0
Lot_Frontage      0
Lot_Area          0
Street            0
                 ..
Sale_Type         0
Sale_Condition    0
Sale_Price        0
Longitude         0
Latitude          0
Length: 81, dtype: int64</code></pre>
<p>What about in the original?</p>
<pre class="python"><code>ameshousingDirty.isnull().sum(axis = 0)</code></pre>
<pre><code>Order               0
PID                 0
MS SubClass         0
MS Zoning           0
Lot Frontage      490
                 ... 
Mo Sold             0
Yr Sold             0
Sale Type           0
Sale Condition      0
SalePrice           0
Length: 82, dtype: int64</code></pre>
<p>Find out what’s the top missing:</p>
<pre class="python"><code>missingNo = ameshousingDirty.isnull().sum(axis = 0).sort_values(ascending = False)
missingNo = missingNo[missingNo.values  &gt; 0]
missingNo</code></pre>
<pre><code>Pool QC           2917
Misc Feature      2824
Alley             2732
Fence             2358
Fireplace Qu      1422
Lot Frontage       490
Garage Qual        159
Garage Yr Blt      159
Garage Cond        159
Garage Finish      159
Garage Type        157
Bsmt Exposure       83
BsmtFin Type 2      81
BsmtFin Type 1      80
Bsmt Cond           80
Bsmt Qual           80
Mas Vnr Type        23
Mas Vnr Area        23
Bsmt Full Bath       2
Bsmt Half Bath       2
Garage Area          1
Garage Cars          1
Total Bsmt SF        1
Bsmt Unf SF          1
BsmtFin SF 2         1
BsmtFin SF 1         1
Electrical           1
dtype: int64</code></pre>
<p>Plot that missingness</p>
<pre class="python"><code>f, ax = plt.subplots(figsize = (10, 20))
sns.barplot(missingNo.values, missingNo.index, ax = ax);</code></pre>
<div class="figure">
<img src="03-EDA_files/03-EDA_21_0.png" alt="" />
<p class="caption">png</p>
</div>
<pre class="python"><code># Use upsetplot to see where missing values occur
# together
# Only use the top 5 columns
missing_cols = missingNo.index[:5].tolist()
missing_counts = (ameshousingDirty.loc[:, missing_cols]
                  .isnull()
                  .groupby(missing_cols)
                  .size())

upsetplot.plot(missing_counts);</code></pre>
<div class="figure">
<img src="03-EDA_files/03-EDA_22_0.png" alt="" />
<p class="caption">png</p>
</div>
<blockquote>
<h3 id="challenge-missingness">Challenge: Missingness</h3>
<p>Compare the entries in the “clean” and “dirty” data frames. How was the data cleaned up?</p>
</blockquote>
<blockquote>
<p>{: .source}</p>
<blockquote>
<h2 id="solution-1">Solution</h2>
<pre><code># poolQC
print(ameshousingDirty[&#39;Pool QC&#39;].value_counts())
print(ameshousingClean[&#39;Pool_QC&#39;].value_counts())
# Misc Feature
print(ameshousingDirty[&#39;Misc Feature&#39;].value_counts())
print(ameshousingClean[&#39;Misc_Feature&#39;].value_counts())
# Alley
print(ameshousingDirty[&#39;Alley&#39;].value_counts())
print(ameshousingClean[&#39;Alley&#39;].value_counts())
# Fence              2358
print(ameshousingDirty[&#39;Fence&#39;].value_counts())
print(ameshousingClean[&#39;Fence&#39;].value_counts())
# Fireplace Qu       1422
print(ameshousingDirty[&#39;Fireplace Qu&#39;].value_counts())
print(ameshousingClean[&#39;Fireplace_Qu&#39;].value_counts())
# Lot Frontage        490
print(ameshousingDirty[&#39;Lot Frontage&#39;].describe())
print(ameshousingClean[&#39;Lot_Frontage&#39;].describe())
# Garage Qual         159
print(ameshousingDirty[&#39;Garage Qual&#39;].value_counts())
print(ameshousingClean[&#39;Garage_Qual&#39;].value_counts())</code></pre>
<p>{: .output} {: .solution} {: .challenge}</p>
</blockquote>
</blockquote>
<hr />
</div>
<div id="explore-the-data-to-see-whether-there-are-any-unusual-relationships-between-variables" class="section level2">
<h2>Explore the data to see whether there are any unusual relationships between variables</h2>
<div id="pull-out-numeric-and-categoric-variables" class="section level4">
<h4>Pull out numeric and categoric variables:</h4>
<ol style="list-style-type: decimal">
<li>What data types do I have in my data? Can I infer that some of them are categorical, and others are not?</li>
</ol>
<pre class="python"><code>ameshousingClean.dtypes.value_counts()</code></pre>
<pre><code>object     46
int64      33
float64     2
dtype: int64</code></pre>
<ol start="2" style="list-style-type: decimal">
<li>Pull out the categorical and numerical variables</li>
</ol>
<pre class="python"><code>catVars = ameshousingClean.select_dtypes(include = [&#39;object&#39;]).columns
numericVars = ameshousingClean.select_dtypes(exclude = [&#39;object&#39;]).columns</code></pre>
<ol start="3" style="list-style-type: decimal">
<li>Plot the first 11 numerical variables, and their relationship with sale price</li>
</ol>
<pre class="python"><code>sns.pairplot(
    ameshousingClean,
    vars = numericVars[np.append(np.arange(0, 10), 32)]
);</code></pre>
<div class="figure">
<img src="03-EDA_files/03-EDA_30_0.png" alt="" />
<p class="caption">png</p>
</div>
<pre class="python"><code>sns.pairplot(
    ameshousingClean,
    diag_kind=&quot;kde&quot;,
    vars = numericVars[np.append(np.arange(11, 21), 32)],
    diag_kws={&#39;bw&#39;: 0.01}
);</code></pre>
<div class="figure">
<img src="03-EDA_files/03-EDA_31_0.png" alt="" />
<p class="caption">png</p>
</div>
<p>Of the numeric variables, which ones are the most correlated (with Sale price, and, more critically, with each other)? &gt; ## Challenge &gt; &gt; What variables are the most correlated with SalePrice? &gt; &gt; &gt; {: .source} &gt; &gt; &gt; ## Solution &gt; &gt; &gt; &gt; ~~~ &gt; &gt; &gt; &gt; ameshousingClean[list(numericVars)].corr().round(2).sort_values(‘Sale_Price’, ascending = False)[‘Sale_Price’] &gt; &gt; &gt; &gt; ~~~ &gt; &gt; &gt; &gt; {: .output} &gt; {: .solution} {: .challenge}</p>
<p>Now generate a correlation plot to visualise this relationship</p>
<pre class="python"><code>corr = ameshousingClean[numericVars].corr()

# Draw the heatmap with the mask and correct aspect ratio
fig, ax = plt.subplots(figsize=(10, 10))
sns.heatmap(corr,
            cmap=plt.cm.BrBG, 
            vmin=-0.5, vmax=0.5, 
            square=True,
            xticklabels=True, yticklabels=True,
            ax=ax);</code></pre>
<div class="figure">
<img src="03-EDA_files/03-EDA_34_0.png" alt="" />
<p class="caption">png</p>
</div>
<pre class="python"><code>sns.lmplot(
    data = ameshousingClean,
    x = &#39;Gr_Liv_Area&#39;, y = &#39;Sale_Price&#39;
);</code></pre>
<div class="figure">
<img src="03-EDA_files/03-EDA_35_0.png" alt="" />
<p class="caption">png</p>
</div>
</div>
<div id="explore-distribution-of-outcome-variable" class="section level3">
<h3>Explore distribution of Outcome variable</h3>
<p>You also need to do EDA on the outcome variable to:</p>
<ul>
<li>identify outliers</li>
<li>explore whether there is any skew in its distribution, and possibly identify a transformation to use when modelling the data</li>
</ul>
<p>This is because many models, including ordinary linear regression, assume that prediction errors (and hence the response) are normally distributed.</p>
<p>Can you see any outliers in the data? Arguably, the five points on the right, wtih Gr_Liv_Area &gt; 4000, are outliers, that can significantly affect the fit of our model. We will filter these out prior to modelling:</p>
<pre class="python"><code>ameshousingClean = ameshousingClean.loc[ameshousingClean[&#39;Gr_Liv_Area&#39;] &lt;= 4000, :]</code></pre>
<blockquote>
<p>The next 2 plots do not need to be demonstrated in class, but are here as notes</p>
</blockquote>
<p>You can also use violin and box plots to explore the relationship between categorical variables and the Outcome</p>
<pre class="python"><code># skip while teaching
f, ax = plt.subplots(figsize = (20, 10))
sns.violinplot(
    x = &#39;Overall_Qual&#39;,
    y = &#39;Sale_Price&#39;,
    data = ameshousingClean,
    ax = ax
);</code></pre>
<div class="figure">
<img src="03-EDA_files/03-EDA_40_0.png" alt="" />
<p class="caption">png</p>
</div>
<pre class="python"><code># skip while teaching
f, ax = plt.subplots(figsize = (20, 10))
sns.boxplot(
    x = &#39;Overall_Qual&#39;,
    y = &#39;Sale_Price&#39;,
    data = ameshousingClean,
    ax = ax
);</code></pre>
<div class="figure">
<img src="03-EDA_files/03-EDA_41_0.png" alt="" />
<p class="caption">png</p>
</div>
<pre class="python"><code># DO INCLUDE this one though
f, ax = plt.subplots(figsize = (20, 10))
sns.distplot(
    ameshousingClean[&#39;Sale_Price&#39;],
    kde = False,
    ax = ax
);</code></pre>
<div class="figure">
<img src="03-EDA_files/03-EDA_42_0.png" alt="" />
<p class="caption">png</p>
</div>
<p>Explore different ways of transforming the Sale Price.</p>
<pre class="python"><code># raw data
sm.qqplot(
    ameshousingClean[&#39;Sale_Price&#39;],
    line = &#39;s&#39;
);</code></pre>
<div class="figure">
<img src="03-EDA_files/03-EDA_44_0.png" alt="" />
<p class="caption">png</p>
</div>
<pre class="python"><code># sqrt transformation
sm.qqplot(
    np.sqrt(ameshousingClean[&#39;Sale_Price&#39;]),
    line = &#39;s&#39;
);</code></pre>
<div class="figure">
<img src="03-EDA_files/03-EDA_45_0.png" alt="" />
<p class="caption">png</p>
</div>
<pre class="python"><code># log transform
sm.qqplot(
    np.log(ameshousingClean[&#39;Sale_Price&#39;]),
    line = &#39;s&#39;
);</code></pre>
<div class="figure">
<img src="03-EDA_files/03-EDA_46_0.png" alt="" />
<p class="caption">png</p>
</div>
<pre class="python"><code># log10 transform
sm.qqplot(
    np.log10(ameshousingClean[&#39;Sale_Price&#39;]),
    line = &#39;s&#39;
);</code></pre>
<div class="figure">
<img src="03-EDA_files/03-EDA_47_0.png" alt="" />
<p class="caption">png</p>
</div>
<blockquote>
<h2 id="challenge-1">Challenge</h2>
<p>If you were working with this dataset, which of the above would you prefer?</p>
<p>{: .source}</p>
<blockquote>
<h2 id="solution-2">Solution</h2>
<p>The log10 transformation seems best, as it both helps the distribution look more normal and helps keep our error metrics and final predictions easily interpretable. It also means that the errors of predicting the values of inexpensive and expensive houses will affect the prediction equally.</p>
<p>{: .output} {: .solution} {: .challenge}</p>
</blockquote>
</blockquote>
</div>
</div>



</div>
</div>

</div>

<script>

// add bootstrap table styles to pandoc tables
function bootstrapStylePandocTables() {
  $('tr.odd').parent('tbody').parent('table').addClass('table table-condensed');
}
$(document).ready(function () {
  bootstrapStylePandocTables();
});


</script>

<!-- tabsets -->

<script>
$(document).ready(function () {
  window.buildTabsets("TOC");
});

$(document).ready(function () {
  $('.tabset-dropdown > .nav-tabs > li').click(function () {
    $(this).parent().toggleClass('nav-tabs-open')
  });
});
</script>

<!-- code folding -->

<script>
$(document).ready(function ()  {

    // move toc-ignore selectors from section div to header
    $('div.section.toc-ignore')
        .removeClass('toc-ignore')
        .children('h1,h2,h3,h4,h5').addClass('toc-ignore');

    // establish options
    var options = {
      selectors: "h1,h2,h3",
      theme: "bootstrap3",
      context: '.toc-content',
      hashGenerator: function (text) {
        return text.replace(/[.\\/?&!#<>]/g, '').replace(/\s/g, '_');
      },
      ignoreSelector: ".toc-ignore",
      scrollTo: 0
    };
    options.showAndHide = true;
    options.smoothScroll = true;

    // tocify
    var toc = $("#TOC").tocify(options).data("toc-tocify");
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
